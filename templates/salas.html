{% extends 'base.html' %}

{% block title %}Lista de Salas{% endblock %}

{% block style %}
.card {
    background-color: #fff;
    padding: 35px;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}
.sala-item {
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 10px;
    background-color: #f9f9f9;
    cursor: pointer;
    transition: all 0.3s;
}
.sala-item:hover {
    background-color: #e7f3ff;
    border-color: #0d6efd;
    transform: translateX(5px);
}
.search-box {
    margin-bottom: 20px;
}
.badge-setor {
    color: white;
    font-size: 0.85rem;
}
.setor-color-0 { background-color: #198754; }
.setor-color-1 { background-color: #6610f2; }
.setor-color-2 { background-color: #20c997; }
.setor-color-3 { background-color: #d63384; }
.setor-color-4 { background-color: #17a2b8; }
.setor-color-5 { background-color: #fd7e14; }
.setor-color-6 { background-color: #ffc107; }
.setor-color-7 { background-color: #0d6efd; }
.setor-color-8 { background-color: #20c997; }
.setor-color-9 { background-color: #0dcaf0; }
.setor-color-10 { background-color: #6c757d; }
.setor-color-11 { background-color: #e83e8c; }
.setor-color-12 { background-color: #9b59b6; }
.setor-color-13 { background-color: #28a745; }
.setor-color-14 { background-color: #3498db; }
.setor-color-15 { background-color: #5a6268; }
{% endblock %}

{% block content %}
<div class="card">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="mb-0">Lista de Salas</h2>
        <a href="javascript:history.back()" class="btn btn-outline-secondary">
            <i class="fas fa-arrow-left"></i> Voltar
        </a>
    </div>

    <div class="search-box position-relative">
        <span class="position-absolute top-50 start-0 translate-middle-y ms-3">
            <i class="fas fa-search text-muted"></i>
        </span>
        <input type="text" id="searchInput" class="form-control form-control-lg" style="padding-left: 2.5rem;" placeholder="Pesquisar por sala ou setor...">
        <span id="clearSearch" class="position-absolute top-50 end-0 translate-middle-y me-3" style="cursor: pointer; display: none;">
            <i class="fas fa-times"></i>
        </span>
    </div>

    <div id="salas-container">
        {% for sala in salas %}
        <div class="sala-item" onclick="window.location.href='{% url 'index_view' sala.id_sala %}'">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h5 class="mb-1">
                        <i class="fas fa-door-open"></i> {{ sala.nome_sala }}
                    </h5>
                    <span class="badge badge-setor {{ sala.setor_color }}">
                        <i class="fas fa-building"></i> {{ sala.nome_setor }}
                    </span>
                </div>
                <div>
                    <i class="fas fa-chevron-right text-muted"></i>
                </div>
            </div>
        </div>
        {% empty %}
        <p class="text-center text-muted">Nenhuma sala encontrada.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    const searchInput = document.getElementById('searchInput');
    const salasContainer = document.getElementById('salas-container');
    const salaItems = salasContainer.querySelectorAll('.sala-item');
    const clearSearch = document.getElementById('clearSearch');

    searchInput.addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase().trim();
        clearSearch.style.display = searchTerm ? 'block' : 'none';

        salaItems.forEach(item => {
            const text = item.textContent.toLowerCase();
            if (text.includes(searchTerm)) {
                item.style.display = 'block';
            } else {
                item.style.display = 'none';
            }
        });
    });

    clearSearch.addEventListener('click', function() {
        searchInput.value = '';
        searchInput.dispatchEvent(new Event('input'));
    });
</script>
{% endblock %}